/*!CK:562273006!*//*1429500564,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["CnQ7+"]); }

__d("CollectionsRecommendationViewportTracking",["DOM","ViewportTracking","copyProperties","csx"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();var k=55,l=200;for(var m in h)if(h.hasOwnProperty(m))o[m]=h[m];var n=h===null?null:h.prototype;o.prototype=Object.create(n);o.prototype.constructor=o;o.__superConstructor__=h;function o(){"use strict";if(h!==null)h.apply(this,arguments);}o.prototype.getDataFromConfig=function(p){"use strict";this.control=p.control;this.useBanzai=false;};o.prototype.getTimeout=function(){"use strict";return l;};o.prototype.getAllStories=function(){"use strict";var p=[].concat(g.scry(this.control,"._3owb")).concat(g.scry(this.control,"._5jvf")).concat(g.scry(this.control,"._3cxw"));return p;};o.prototype.getStoryID=function(p){"use strict";var q=JSON.parse(p.getAttribute('data-gt'));return q&&q.token;};o.prototype.getDataToLog=function(p){"use strict";var q=i(JSON.parse(p.getAttribute('data-gt')),{evt:k});return {gt:q};};o.init=function(p){"use strict";var q=new o();q.init(p);return q;};e.exports=o;},null);
__d("TimelineCollectionAddRecommendation",["Event","AppSectionCurationState","AsyncRequest","CollectionsRecommendationViewportTracking","CSS","DOM","OGCollectionAddObject","OnVisible","Parent","TimelineAppCollection","TimelineAppSection","TimelineAppSectionCuration","ProfileOverviewSection","TriggerablePageletLoader","$","csx","cx","tidyEvent","copyProperties","DataStore"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z){b.__markCompiled&&b.__markCompiled();var aa={},ba="_5737",ca=250;m.subscribe(m.ADD_PLACEHOLDER,function(la,ma){p.incrementCount(ma);});m.subscribe(m.REMOVE_PLACEHOLDER,function(la,ma){p.decrementCount(ma);});function da(la){var ma=l.scry(la,"._3owb")[0];if(ma)return ma.getAttribute('data-obj');}function ea(la,ma){if(ma){var na=ma.nextSibling;na&&ia(na);aa[la].carousel.removeItem(ma);}aa[la].carousel.refresh();}function fa(la,ma){var na=[],oa=aa[la].carousel.getVisibleNodes(),pa=da(ma);for(var qa=0;qa<oa.length;++qa){var ra=da(oa[qa]);if(pa===ra)break;if(ra)na.push(ra);}return na;}function ga(la){var ma=[],na=aa[la].carousel.getVisibleNodes(),oa=aa[la].carousel.getVisibleNodesMax();for(var pa=1;pa<oa-1;pa++){if(pa===na.lentgh)break;var qa=da(na[pa]);if(qa)ma.push(qa);}return ma;}function ha(la,ma){var na=fa(la,ma);ea(la,ma);return na;}function ia(la){k.addClass(la,"_42fn");var ma=g.listen(la,'mouseover',function(){k.removeClass(la,"_42fn");ma.remove();});}function ja(la){var ma=aa[la];if(ma.filled)return;var na=q.getIDBySK(ma.data.sk);s.callWithSection(na,function(oa){var pa=oa.getActiveCollection().getToken(),qa=r.getSectionState(na);if(pa==ma.collectionToken&&qa===h.showItems&&ma.items.length>0){ma.filled=true;ma.carousel.addItems(ma.items);}});}var ka={addTriggerLoader:function(la,ma,na){new t({controller:'TimelineAppCollectionRecommendationPagelet',data:na,node:la,options:{crossPage:1,jsNonblock:1}},[{node:ma,type:t.TRIGGER_ONVISIBLE}]);},removeItemsByObjectIDs:function(la,ma){var na=aa[ma];if(!na)return;var oa=aa[ma].carousel.getNode();la.forEach(function(pa){var qa=l.scry(oa,'[data-obj="'+pa+'"]')[0];if(qa){var ra=o.byClass(qa,"_58rc");ha(ma,ra);}});},getPreviousItemIDs:function(la,ma){return fa(la,ma);},getPageletID:function(la){return 'pagelet_recommendation_'+la.split(':')[2];},init:function(la,ma,na,oa){var pa=aa[la]={carousel:ma,collectionToken:na.collection_token,data:na,isFirst:true,showPlusButtonItem:oa.items[0],items:oa.items,postUri:oa.post_uri,removeUri:oa.remove_uri,nextLinkData:oa.next_link_data,filled:oa.filled,headerPageletID:oa.header_pagelet_id,viewportTracking:j.init({control:ma.getNode()})};new n(pa.carousel.getNode(),function(){var ra=function(){ja(la);};q.subscribe('changeCollection',ra);r.register(q.getIDBySK(na.sk),ra);ra();},true,0);var qa=g.listen(pa.carousel.getNode(),'mouseenter',function(ra){qa.remove();if(pa.showPlusButtonItem)k.removeClass(pa.showPlusButtonItem,ba);});x([pa.carousel.subscribe('needsitems',ka.reloadRecommendation.bind(null,pa)),pa.carousel.subscribe('refreshed',pa.viewportTracking.fireTimer.bind(pa.viewportTracking)),pa.carousel.subscribe('lastelementremoved',function(ra){r.informState(h.hide,na.header_pagelet_id);setTimeout(function(){p.switchToNullStateCurationContent(na.collection_token);},ca);})]);x(g.listen(pa.carousel.getNextLink(),'mousedown',function(ra){pa.nextLinkData.rec_list_items=ga(la);pa.carousel.getNextLink().setAttribute('data-gt',JSON.stringify(pa.nextLinkData));}));x(g.listen(pa.carousel.getNode(),'click',function(ra){var sa=o.byTag(ra.getTarget(),'a');if(!sa)return;var ta="_gx8",ua="_vfm",va="_4-k4",wa=k.hasClass(sa,ta)||k.hasClass(sa,ua),xa=!wa&&k.hasClass(sa,va);if(wa||xa){var ya=o.byClass(sa,"_58rc"),za=l.find(ya,"._3owb"),ab=za.getAttribute('data-obj'),bb=JSON.parse(z.get(za,'post',null)),cb=ha(la,ya);if(wa){p.addPlaceholderToCollection(pa.collectionToken,ya);var db=pa.isFirst||0;delete pa.isFirst;new i(pa.postUri).setData(y({action:'add',item_id:ab,ignored_item_ids:cb,is_first:db,underlying_entity_id:ab,log_feedback:Number(na.taste_items_ids.hasOwnProperty(ab))},bb)).send();ra.prevent();}else new i(pa.removeUri).setData(y({objectid:ab,ignored_item_ids:cb},bb)).send();}}));},reloadRecommendation:function(la){if(!la.asyncing&&la.filled)la.asyncing=new i('/ajax/open_graph/recommendation_reload/').setData(la.data).send();},requestSuggestions:function(la,ma){if(!(la in aa))return;var na=aa[la].data;new i('/ajax/open_graph/similar_suggestions/').setData({pagelet_id:la,ogobjectid:ma,session_id:na.session_id,collection_token:na.collection_token}).setRelativeTo(u(q.getIDBySK(na.sk))).setHandler(this.onRequestSuggestionsComplete.bind(this,la)).send();},onRequestSuggestionsComplete:function(la){r.refreshState(h.showItems,q.getIDBySK(aa[la].data.sk));},removeItemFromRecommendations:function(la,ma){return ha(la,ma);},plusRecommendation:function(la,ma,na,oa,pa,qa){var ra=aa[la];p.addPlaceholderToCollection(pa,na);var sa=aa[ma];if(la!=ma&&sa){var ta=l.scry(sa.carousel.getNode(),'[data-obj="'+oa+'"]');if(ta&&ta.length>0){var ua=o.byClass(ta[0],"_58rc");ea(ma,ua);}}var va=null;if(qa){va=ha(la,na);}else va=fa(la,na);var wa=ra.isFirst||0;delete ra.isFirst;return {ignored_item_ids:va,is_first:wa,session_id:ra.sessionID};},populateSuggestionsList:function(la,ma,na,oa,pa){var qa=aa[la];qa.asyncing=false;if(ma.length===0){qa.carousel.endCarousel();}else{qa.data.exclude_ids=na;y(qa.data.taste_items_ids,oa);qa.carousel.addItems(ma);qa.data.cursor=pa;}}};e.exports=ka;},null);
__d("TimelineCollectionAddTagSuggestItem",["Arbiter","Ease","cx","csx","Parent","DOM","CSS","Animation","TimelineCollectionAddRecommendation"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){b.__markCompiled&&b.__markCompiled();function p(q,r,s,t,u){"use strict";this.$TimelineCollectionAddTagSuggestItem0=r;this.$TimelineCollectionAddTagSuggestItem1=s;this.$TimelineCollectionAddTagSuggestItem2=u;this.$TimelineCollectionAddTagSuggestItem3=k.byAttribute(r,q);this.$TimelineCollectionAddTagSuggestItem4=l.scry(r,"._5enm")[0];this.$TimelineCollectionAddTagSuggestItem5=l.find(r,"._5epd");this.$TimelineCollectionAddTagSuggestItem6=l.find(r,"._5ynk");this.$TimelineCollectionAddTagSuggestItem7=l.find(r,"._5eob");this.$TimelineCollectionAddTagSuggestItem8=l.find(r,"._5ep9");t.subscribe('confirm',this.$TimelineCollectionAddTagSuggestItem9.bind(this));t.subscribe('reject',this.$TimelineCollectionAddTagSuggestItema.bind(this));g.subscribe('PhotoTagger.TAG_SUGGESTION_CONFIRMED/'+this.$TimelineCollectionAddTagSuggestItem2,this.$TimelineCollectionAddTagSuggestItem9.bind(this));g.subscribe('PhotoTagger.TAG_SUGGESTION_REJECTED/'+this.$TimelineCollectionAddTagSuggestItem2,this.$TimelineCollectionAddTagSuggestItema.bind(this));}p.prototype.$TimelineCollectionAddTagSuggestItem9=function(){"use strict";this.$TimelineCollectionAddTagSuggestItemb();this.$TimelineCollectionAddTagSuggestItemc(this.$TimelineCollectionAddTagSuggestItem5,1,.4,400).go();this.$TimelineCollectionAddTagSuggestItemc(this.$TimelineCollectionAddTagSuggestItem6,0,1,400).go();setTimeout(function(){this.$TimelineCollectionAddTagSuggestItemc(this.$TimelineCollectionAddTagSuggestItem0,1,0,400).checkpoint(1,this.$TimelineCollectionAddTagSuggestItemd.bind(this)).go();}.bind(this),750);};p.prototype.$TimelineCollectionAddTagSuggestItema=function(){"use strict";this.$TimelineCollectionAddTagSuggestItemb();this.$TimelineCollectionAddTagSuggestItemc(this.$TimelineCollectionAddTagSuggestItem5,1,.4,600).go();this.$TimelineCollectionAddTagSuggestItemc(this.$TimelineCollectionAddTagSuggestItem0,1,0,600).checkpoint(1,this.$TimelineCollectionAddTagSuggestItemd.bind(this)).go();};p.prototype.$TimelineCollectionAddTagSuggestItemb=function(){"use strict";m.hide(this.$TimelineCollectionAddTagSuggestItem4);m.hide(this.$TimelineCollectionAddTagSuggestItem7);m.hide(this.$TimelineCollectionAddTagSuggestItem8);m.addClass(this.$TimelineCollectionAddTagSuggestItem0,"_5ynj");};p.prototype.$TimelineCollectionAddTagSuggestItemc=function(q,r,s,t){"use strict";return new n(q).from('opacity',r).to('opacity',s).ease(h.makePowerInOut(2)).duration(t);};p.prototype.$TimelineCollectionAddTagSuggestItemd=function(){"use strict";o.removeItemFromRecommendations(this.$TimelineCollectionAddTagSuggestItem1,this.$TimelineCollectionAddTagSuggestItem3);};e.exports=p;},null);
__d("TimelineCollectionAddTagSuggestSelector",["AsyncRequest","ArbiterMixin","tidyEvent","mixin","Event"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();var l=j(h);for(var m in l)if(l.hasOwnProperty(m))o[m]=l[m];var n=l===null?null:l.prototype;o.prototype=Object.create(n);o.prototype.constructor=o;o.__superConstructor__=l;function o(p,q,r,s,t,u){"use strict";this.$TimelineCollectionAddTagSuggestSelector0=p;this.$TimelineCollectionAddTagSuggestSelector1=t;this.$TimelineCollectionAddTagSuggestSelector2=u;i(k.listen(p,'click',this.$TimelineCollectionAddTagSuggestSelector3.bind(this,r,'confirm')),k.listen(q,'click',this.$TimelineCollectionAddTagSuggestSelector3.bind(this,s,'reject')));}o.prototype.$TimelineCollectionAddTagSuggestSelector3=function(p,event){"use strict";this.inform(event);new g(p).setData(this.$TimelineCollectionAddTagSuggestSelector4(event)).send();};o.prototype.$TimelineCollectionAddTagSuggestSelector4=function(event){"use strict";return event=='confirm'?this.$TimelineCollectionAddTagSuggestSelector1:this.$TimelineCollectionAddTagSuggestSelector2;};e.exports=o;},null);
__d("TimelineCollectionUnlikeHandler",["Arbiter","AsyncRequest","CSS","PageLikeButton","TimelineAppCollection"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();var l={},m={init:function(n,o,p){l[n]={buttons:p,collectionToken:o};g.subscribe(j.UNLIKED,this._showUndo);g.subscribe('Collection/removeProfileConnection',this._showUndo);},_showUndo:function(n,o){var p=l[o.profile_id];if(p){i.hide(p.buttons);k.decrementCount(k.getIDByToken(p.collectionToken));new h('/ajax/timeline/app_collection_item/unlike/fbpage/').setData({collection_token:p.collectionToken,profile_id:o.profile_id}).send();l[o.profile_id]=null;}}};e.exports=m;},null);